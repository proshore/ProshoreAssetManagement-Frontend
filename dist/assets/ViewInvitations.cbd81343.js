import{v as N}from"./validateEmail.64dd81f6.js";import{k as f,A as b,_ as y,r as A,o as c,c as m,a as e,b as g,f as h,v as B,t as d,h as E,l as V,F as I,d as u,m as U,q as D,p as S,j as M,s as T,n as p}from"./index.28748bfc.js";import{B as L}from"./BaseAlert.30ed51dd.js";const F=t=>{const s={isValid:!1,errorMessage:""},l=/^[a-zA-Z0-9_.-]*$/i;return t.length<3&&(s.errorMessage="Name should be at least 3 letters long",s.isValid=!1),l.test(t)||(s.errorMessage="Please enter a valid username",s.isValid=!1),{...s,isValid:!0}},$="api/users/invite",Q="/api/users/invite/resend",q="/api/users/invite/revoke",Y="",z="api/users/invite",_={INVITE_URL:$,RESEND_INVITE_URL:Q,REVOKE_INVITE_URL:q,DELETE_INVITE_URL:Y,INVITATION_LIST_URL:z},J=async t=>{const s={headers:{"Content-Type":"application/json",Authorization:"Bearer "+f()}};return await b.post(_.INVITE_URL,t,s)},K=async t=>{const s={headers:{"Content-Type":"application/json",Authorization:"Bearer "+f()}};return await b.post(`${_.RESEND_INVITE_URL}/${t.id}`,t,s)},X=async t=>await b.get(`${_.REVOKE_INVITE_URL}/${t.id}`,t),j=async()=>{const t=f(),s={headers:{"Content-Type":"application/json",Authorization:"Bearer "+t}};return await b.get(_.INVITATION_LIST_URL,s)},G="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAEFSURBVHgB7drBDYJAEIXhN1ZgFdqCliENaAdqBUoFSgfaAHVgC9AEFTAuEA6QPTKOJO+7uRfyJwKZCQIju6S6KXDpf+nrk2+uMCAwsE+qh0Iv41NNi3x7x8xWMNAAp+mZQM4wYBIg0PX0LPyd1jBgEvBLDPDGAG8M8MYAbwzwxgBvDPDGAG/dTDwM4LFJ6h8ppB4WBRIfwJdC01VsAF+KdlGw/JtY0GRYKm3e3U28P5TPRnAUo9XH3MIDpw4PnKxdlJls5nZJqbHzIt/Mfj2+yLwxwBsDvDHAGwO8McAbA7wxwBsDYvq9zVgYxWoYMPrUILIoCAM4DJjMxK1hUdBfpB/AYeALZMpEN6IjwuQAAAAASUVORK5CYII=",O="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAXCAYAAADgKtSgAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFPSURBVHgBpdU7TsNAEAbgGSdLE4rcAFMQCUHhFRI1OVHECQgnQDlBOAI3gJpmQ4EiQeMjuIAGWx5mbRny8D7zN5HWu98feWQbgaPUOgUxmNUAb1eXk0c4IEqpMRwdz4CxYbMiBksCuEF98f3zRF6c3UNENExi9AxEGTCWNKuERbeBiOZccAeB+YMBsm6txavqltk8tqAP5qzwf8M6JZHwBky7NUScu26RES6/p7i9MazABkspC9w/4Ffggptz/f/IXuADG3FbAfx8LXxgK24q4BM5EKQu2IkbCzxgL1znVX1kQwFqZ7lg+NQE6yTgiB4ew8ueS+07xBJ0wT3D2wYsz0ESCK+qEqTvqyIJgfXwruWEf+upTwGGwJvD83mSMQb2LcBY2KcAD4FdBe1AxeghFtaR8jzvG3L3mRvHwraCBi8r0gN4IaoXMfB+gbbw6Rd6pCuO/CF7vQAAAABJRU5ErkJggg==";const P={name:"InviteUser",data(){return{name:{value:"",error:""},email:{value:"",error:""},role_id:{value:0},submission:{message:"",isVerified:!1}}},components:{BaseAlert:L},methods:{formData(){return{email:this.email.value,name:this.name.value,role_id:parseInt(this.role_id.value)}},clearFormData(){this.email.value="",this.email.error="",this.name.value="",this.name.error="",this.role_id.value=0,this.submission.message="",this.submission.isVerified=!1},validateField(t){if(t==="name"){let s=F(this.name.value);this.name.error=s.errorMessage}if(t==="email"){let s=N(this.email.value);this.email.error=s.errorMessage}},async handleSubmit(){if(!this.submission.isVerified){if(!this.name.value||!this.email.value||!this.role_id.value)return this.submission.message="Field must not be empty";if(this.name.error||this.email.error)return this.submission.message="Some fields are not filled properly";try{const t=await J(this.formData());t.data.message,(t.data.success=!0)&&(this.submission.message="Sent Successful",this.submission.isVerified=!0,setTimeout(()=>{document.getElementById("inviteBtn").setAttribute("data-bs-dismiss","modal"),document.getElementById("inviteBtn").click(),this.clearFormData()},2e3))}catch(t){this.submission.message=t.response.data.message}}}}},H=e("button",{type:"button",class:"btn invite-button button-color px-4 py-2","data-cy":"invite-btn","data-bs-toggle":"modal","data-bs-target":"#exampleModal"},[e("i",{class:"bi bi-plus-lg me-2",style:{"font-size":"1.5rem"}}),u(" Invite member ")],-1),W={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true","data-bs-backdrop":"static","data-bs-keyboard":"false"},Z={class:"modal-dialog"},ee={class:"modal-content"},te={class:"add-a-dialog-box screen"},se=U('<div class="title"><div class="title-left"><div class="header-frame"><img src="'+G+'" alt="" class="plus-stroke"><div class="invite-new-member">Invite new member</div></div><p class="add-a-new-member-to-proshore"> Add a new member to proshore </p></div><div class="close-button"><button class="close-rectangle" type="button" data-cy="close-invite-btn" data-bs-dismiss="modal"><img src="'+O+'" alt="" class="x-lg"></button></div></div>',1),oe={class:"row w-100 d-flex justify-content-center"},ae={class:"input-frame"},ie={class:"input-with-label"},ne=e("div",{class:"label"},"Full Name",-1),le=["textContent"],re={class:"input-with-label"},de=e("div",{class:"label"},"Email",-1),ce=["textContent"],me={class:"input-with-label"},ue=e("div",{class:"label"},"Role",-1),ve=e("option",{selected:"",value:"0"},"Select a Role",-1),be=e("option",{"data-cy":"invite-select-employee",value:"1"}," Employee ",-1),_e=e("option",{"data-cy":"invite-select-vendor",value:"2"},"Vendor",-1),he=[ve,be,_e],pe={class:"button-frame"},Ae=e("div",{class:"outline-button"},[e("button",{class:"primary button",type:"button","data-cy":"invite-cancel-btn","data-bs-dismiss":"modal"}," Cancel ")],-1),ge={class:"invite-button"};function fe(t,s,l,x,o,a){const r=A("BaseAlert");return c(),m(I,null,[H,e("div",W,[e("div",Z,[e("div",ee,[e("div",te,[se,e("div",oe,[g(r,{submission:o.submission},null,8,["submission"])]),e("div",ae,[e("div",ie,[ne,h(e("input",{type:"text",placeholder:"Username",class:"input-text","onUpdate:modelValue":s[0]||(s[0]=i=>o.name.value=i),onKeyup:s[1]||(s[1]=i=>a.validateField("name")),"data-cy":"invite-name"},null,544),[[B,o.name.value]]),o.name.error?(c(),m("div",{key:0,class:"form-text text-danger",textContent:d(o.name.error)},null,8,le)):E("",!0)]),e("div",re,[de,h(e("input",{type:"email",placeholder:"ex: myworkmail@gmail.com",class:"input-text","onUpdate:modelValue":s[2]||(s[2]=i=>o.email.value=i),onKeyup:s[3]||(s[3]=i=>a.validateField("email")),"data-cy":"invite-email"},null,544),[[B,o.email.value]]),o.email.error?(c(),m("div",{key:0,class:"form-text text-danger",textContent:d(o.email.error)},null,8,ce)):E("",!0)]),e("div",me,[ue,h(e("select",{class:"input-text","aria-label":"Default select example","onUpdate:modelValue":s[4]||(s[4]=i=>o.role_id.value=i)},he,512),[[V,o.role_id.value]])])]),e("div",pe,[Ae,e("div",ge,[e("button",{class:"primary-1 button-1 button-color",id:"inviteBtn","data-cy":"invite-send-btn",onClick:s[5]||(s[5]=(...i)=>a.handleSubmit&&a.handleSubmit(...i))}," Send Invitation ")])])])])])])],64)}const k=y(P,[["render",fe]]);const ye={data(){return{modalInvoker:{text:"",method:null}}},props:{name:{type:String,required:!0},email:{type:String,required:!0},contact:{type:String,required:!0},id:{type:String,required:!0}},emits:["deleteInvite"],methods:{bodyData(){return{token:"1bxXVTgMmdgiClqXZ8Rdmg",data:{name:this.name,email:this.email}}},async reInviteMember(){try{const t=await K(this.bodyData())}catch{}},async revokeMember(){try{const t=await X(this.bodyData())}catch{}},async deleteMember(){try{const t=await D.delete(`https://6319958e8e51a64d2be7568b.mockapi.io/invitedUsers/${this.id}`);this.$emit("deleteInvite")}catch{}},setInvoker(t){t.target.id==="revoke"&&(this.modalInvoker.text="revoke",this.modalInvoker.method=this.revokeMember),t.target.id==="delete"&&(this.modalInvoker.text="delete",this.modalInvoker.method=this.deleteMember)}}},v=t=>(S("data-v-83ec028f"),t=t(),M(),t),Ie={class:"btn-group dropstart"},xe=v(()=>e("button",{class:"btn three-dot-btn d-flex justify-content-center align-items-center","data-cy":"invitation-action-toggle-btn","data-bs-toggle":"dropdown"},[e("i",{class:"bi bi-three-dots-vertical",style:{color:"#FA6731","font-size":"1.5rem"}})],-1)),we={class:"dropdown-menu"},Be=v(()=>e("i",{class:"bi bi-send me-4",style:{color:"#CED4DA"}},null,-1)),Ee=u("Resend Invitation "),ke=[Be,Ee],Ce=["data-bs-target"],Ue=v(()=>e("i",{class:"bi bi-dash-square-fill me-4",style:{color:"#FA6731"}},null,-1)),Se=u("Revoke Member "),Me=[Ue,Se],Re=["data-bs-target"],Ne=v(()=>e("i",{class:"bi bi-trash3-fill me-4",style:{color:"#FA6731"}},null,-1)),Ve=u("Delete Entry "),De=[Ne,Ve],Te=["id"],Le={class:"modal-dialog modal-dialog-centered",role:"document"},Fe={class:"modal-content"},$e=v(()=>e("div",{class:"modal-header"},[e("h5",{class:"modal-title m-auto ps-5",id:"exampleModalLongTitle"},"Are you sure?"),e("button",{type:"button",class:"btn close conformation-box-close-btn second-button-color","data-bs-dismiss":"modal","data-cy":"conformation-box-close-btn","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"\xD7")])],-1)),Qe={class:"modal-body d-flex justify-content-center"},qe={class:"w-75 text-center"},Ye={class:"modal-footer d-flex justify-content-center"},ze=v(()=>e("button",{type:"button",class:"btn conformation-box-no-btn second-button-color","data-cy":"conformation-box-no-btn","data-bs-dismiss":"modal"},"No",-1));function Je(t,s,l,x,o,a){return c(),m(I,null,[e("div",Ie,[xe,e("div",we,[e("li",null,[e("a",{class:"dropdown-item",href:"#","data-cy":"resend-invitation-link",onClick:s[0]||(s[0]=r=>a.reInviteMember({name:l.name,email:l.email}))},ke)]),e("li",null,[e("a",{class:"dropdown-item text-danger",href:"#","data-cy":"revoke-invitation-link","data-bs-toggle":"modal","data-bs-target":"#_"+l.contact,id:"revoke",onClick:s[1]||(s[1]=r=>a.setInvoker(r))},Me,8,Ce)]),e("li",null,[e("a",{class:"dropdown-item text-danger",href:"#","data-cy":"delete-invitation-link","data-bs-toggle":"modal","data-bs-target":"#_"+l.contact,id:"delete",onClick:s[2]||(s[2]=r=>a.setInvoker(r))},De,8,Re)])])]),e("div",{class:"modal fade",id:"_"+l.contact,tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalCenterTitle","aria-hidden":"true"},[e("div",Le,[e("div",Fe,[$e,e("div",Qe,[e("p",qe,[u("Do you want to "+d(o.modalInvoker.text)+" the invitation of ",1),e("b",null,d(l.name),1),u(" ? Once "+d(`${o.modalInvoker.text}d`)+" it cannot be undone.",1)])]),e("div",Ye,[ze,e("button",{type:"button",class:"btn conformation-box-yes-btn text-white button-color","data-cy":"conformation-box-yes-btn",onClick:s[3]||(s[3]=(...r)=>o.modalInvoker.method&&o.modalInvoker.method(...r)),"data-bs-dismiss":"modal"},"Yes")])])])],8,Te)],64)}const C=y(ye,[["render",Je],["__scopeId","data-v-83ec028f"]]);const Ke={components:[k,C],data(){return{invitations:[]}},components:{InvitationActions:C,InviteUser:k},mounted(){this.getInvitationList()},computed:{styleRole(){return t=>{const s=t.toLowerCase();if(s==="employee")return"role-employee";if(s==="vendor")return"role-vendor"}},styleStatus(){return t=>{const s=t.toLowerCase();if(s==="active")return"status-pending";if(s==="inactive")return"status-expired"}},styleDotIcon(){return t=>{const s=t.toLowerCase();if(s==="active")return"status-pending-icon";if(s==="inactive")return"status-expired-icon"}}},methods:{async getInvitationList(){try{const t=await j();console.log("response",t),this.invitations=t.data.data.invited_users}catch{}},refreshInvitationList(){this.getInvitationList()}}},R=t=>(S("data-v-83d7b51c"),t=t(),M(),t),Xe={class:"invitation-container p-4 mt-4 mx-4"},je={class:"row px-3"},Ge=U('<div class="col-4" data-v-83d7b51c><form class="form-inline d-flex" data-v-83d7b51c><input class="form-control form-control-lg mr-sm-2" type="search" placeholder="Search" aria-label="Search" data-cy="invitations-search-field" data-v-83d7b51c><button class="btn my-2 px-3 my-sm-0 mx-2 button-color" type="submit" data-cy="invitation-search-btn" data-v-83d7b51c><i class="bi bi-search" data-v-83d7b51c></i></button></form></div>',1),Oe={class:"col-8 d-flex justify-content-end"},Pe={class:"row mt-4 px-4"},He={class:"table table-borderless border table-hover table-sm bg-white regular-font"},We=R(()=>e("thead",{class:"thead-light"},[e("tr",{class:"text-center"},[e("th",{scope:"col"},"S.N"),e("th",{scope:"col"},"Member Full Name"),e("th",{scope:"col"},"Email Address"),e("th",{scope:"col"},"Contact Number"),e("th",{scope:"col"},"Role"),e("th",{scope:"col"},"Status"),e("th",{scope:"col"},"Action")])],-1)),Ze={class:"text-center"},et={scope:"row"},tt=R(()=>e("td",null,"1234567890",-1));function st(t,s,l,x,o,a){const r=A("InviteUser"),i=A("InvitationActions");return c(),m("div",Xe,[e("div",je,[Ge,e("div",Oe,[g(r)])]),e("div",Pe,[e("table",He,[We,(c(!0),m(I,null,T(o.invitations,(n,w)=>(c(),m("tbody",{key:w},[e("tr",Ze,[e("th",et,d(w+1),1),e("td",null,d(n.name),1),e("td",null,d(n.email),1),tt,e("td",{class:p(`role ${a.styleRole(n.role.name)}`)},d(n.role.name),3),e("td",null,[e("div",{class:p(`status ${a.styleStatus(n.status)}`)},[e("div",{class:p(["status-icon me-2",` ${a.styleDotIcon(n.status)}`])},null,2),u(" "+d(n.status),1)],2)]),e("td",null,[g(i,{name:n.name,email:n.email,contact:n.contact,id:n.id,onDeleteInvite:a.refreshInvitationList},null,8,["name","email","contact","id","onDeleteInvite"])])])]))),128))])])])}const nt=y(Ke,[["render",st],["__scopeId","data-v-83d7b51c"]]);export{nt as default};
